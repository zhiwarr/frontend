import{Q as a,R as c,D as s}from"./index-jvsXQBcr.js";const l=a({id:"cart",state:()=>({cartItems:JSON.parse(localStorage.getItem("cartItems"))||[],subtotal:0,totalAmount:0,coupon:"",couponDetails:{discount:0,discount_type:"",cart_total:0,coupon_name:"",coupon_code:""},selectedAddressObject:{},selectedShippingAreaObject:{},selectedShippingMethod:null,selectedShippingAddress:null}),actions:{addToCart(t){this.cartItems.push(t),this.saveCartToLocalStorage(),this.calculateSubtotal(),this.calculateTotalAmount()},removeFromCart(t){this.cartItems.splice(t,1),this.saveCartToLocalStorage(),this.calculateSubtotal(),this.calculateTotalAmount()},updateCartItem({index:t,newCartItem:o}){this.cartItems[t]=o,this.saveCartToLocalStorage(),this.calculateSubtotal(),this.calculateTotalAmount()},saveCartToLocalStorage(){localStorage.setItem("cartItems",JSON.stringify(this.cartItems))},calculateSubtotal(){this.subtotal=this.cartItems.reduce((t,o)=>t+o.unit_price*o.qty,0)},calculateTotalAmount(){const t=this.couponDetails.discount||0;this.totalAmount=Math.max(0,this.subtotal-t)},applyCoupon(t){c.post("http://127.0.0.1:8000/api/v1/apply-coupon",{coupon_code:t}).then(o=>{const e=o.data.coupon;this.coupon=t,e?(this.couponDetails={discount:e.discount,discount_type:e.discount_type,coupon_name:e.coupon_name,coupon_code:e.coupon_code,cart_total:this.subtotal},console.log(this.couponDetails),this.calculateCouponDiscount(),s.success(o.data.message)):s.error("Invalid coupon")}).catch(o=>{console.error("Error applying coupon:",o),s.error("Failed to apply coupon")})},calculateCouponDiscount(){const t=this.couponDetails.discount_type,o=this.couponDetails.discount;let e=0;t==="percent"?e=this.subtotal*o/100:t==="amount"&&(e=o),this.couponDetails.discount=e,this.calculateTotalAmount()},setSelectedAddressObject(t){this.selectedAddressObject=t},setSelectedShippingAreaObject(t){this.selectedShippingAreaObject=t},destroyCart(){this.cartItems=[],this.subtotal=0,this.totalAmount=0,this.coupon="",this.couponDetails={discount:0,discount_type:"",cart_total:0,coupon_name:"",coupon_code:""},this.selectedAddressObject={},this.selectedShippingAreaObject={},this.selectedShippingMethod=null,this.selectedShippingAddress=null,localStorage.removeItem("cartItems")}}});export{l as u};
